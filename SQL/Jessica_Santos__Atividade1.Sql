USE Atividade01_SQL;

CREATE TABLE APP_TELAS -- Entidade 3
(
	ID				INT				NOT NULL IDENTITY(1, 1),
	NOME_TELA		VARCHAR(50)		NOT NULL,
	DESCRICAO_TELA	VARCHAR(500)	NULL,
	END_ACESSO_TELA	VARCHAR(50)		NOT NULL,
	STATUS_TELA		VARCHAR(50)		NULL,
	CONSTRAINT		PK_APP_TELAS	PRIMARY KEY (ID)
);

CREATE TABLE PERFIL_USUARIO -- Entidade 1
(
	ID			INT				NOT NULL IDENTITY(1, 1),
	NOME		VARCHAR(50)		NOT NULL,
	DESCRICAO	VARCHAR(500)	NULL,
	CONSTRAINT 	PK_PERFIL_USUARIO PRIMARY KEY (ID)
);

CREATE TABLE USUARIO -- Entidade 2
(
	ID					INT				NOT NULL IDENTITY(1, 1),
	ID_PERFIL_USUARIO	INT 			NOT NULL,
	ID_APP_TELAS		INT				NOT NULL,
	NOME				VARCHAR(100)	NOT NULL,
	LOGIN				VARCHAR(50)		NOT NULL,
	SENHA				VARCHAR(30)		NOT NULL,
	EMAIL				VARCHAR(50)		NOT NULL,
	DT_ULT_ACCESSO		DATE			NULL,
	CONSTRAINT PK_USURIOS PRIMARY KEY (ID),
	CONSTRAINT FK_USUARIO_PERFIL_USUARIO FOREIGN KEY (ID_PERFIL_USUARIO)
	REFERENCES PERFIL_USUARIO (ID),
	CONSTRAINT FK_USUARIO_APP_TELAS FOREIGN KEY (ID_APP_TELAS)
	REFERENCES APP_TELAS (ID)
);

CREATE TABLE CLIENTES -- Entidade 4
(
	ID				INT				NOT NULL IDENTITY(1, 1),
	NOME			VARCHAR(50)		NOT NULL,
	SOBRENOME		VARCHAR(100)	NULL,
	DT_NASC			DATE			NULL,
	NATURALIDADE	VARCHAR(50)		NULL,
	NOME_MAE		VARCHAR(150)	NULL,
	NOME_PAI		VARCHAR(150)	NULL,
	CONSTRAINT PK_CLIENTES PRIMARY KEY (ID)
);

CREATE TABLE CLIENTE_EMAILS
(
	ID			INT NOT NULL IDENTITY(1, 1),
    ID_CLIENTE  INT NOT NULL,
	EMAIL		VARCHAR(50)	NOT NULL,
	CONSTRAINT 	PK_CLIENTE_EMAILS PRIMARY KEY (ID),
	CONSTRAINT 	FK_CLIENTE_EMAILS_CLIENTES FOREIGN KEY (ID_CLIENTE)
	REFERENCES 	CLIENTES (ID)
);

CREATE TABLE CLIENTE_TELEFONES
(
	ID				INT			NOT NULL IDENTITY(1, 1),
	ID_CLIENTE	INT			NOT NULL, 
	DDD				VARCHAR(3)	NOT NULL,
	N_TELEFONE		VARCHAR(9)	NOT NULL,
	TIPO_TELEFONE	VARCHAR(10)	NOT NULL,
	CONSTRAINT PK_CLIENTE_TELEFONES PRIMARY KEY (ID),
	CONSTRAINT FK_CLIENTE_TELEFONES_CLIENTES FOREIGN KEY (ID_CLIENTE)
	REFERENCES CLIENTES (ID)
);

CREATE TABLE TIPO_DOCUMENTOS
(
	ID			INT				NOT NULL IDENTITY(1, 1),
	NOME		VARCHAR(50)		NOT NULL,
	DESCRICAO	VARCHAR(500)	NULL,
	CONSTRAINT 	PK_TIPO_DOCUMENTOS PRIMARY KEY (ID)
);

CREATE TABLE CLIENTE_DOCUMENTOS
(
	ID					INT			NOT NULL IDENTITY(1, 1),
	ID_CLIENTE			INT			NOT NULL,
	ID_TIPO_DOCUMENTOS	INT			NOT NULL,
	N_DOCUMENTO			VARCHAR(50)	NOT NULL,
	CONSTRAINT PK_CLIENTE_DOCUMENTOS PRIMARY KEY (ID),
	CONSTRAINT FK_CLIENTE_DOCUMENTOS_CLIENTES FOREIGN KEY (ID_CLIENTE)
	REFERENCES CLIENTES (ID),
	CONSTRAINT FK_CLIENTE_DOCUMENTOS_TIPO_DOCUMENTOS FOREIGN KEY (ID_TIPO_DOCUMENTOS)
	REFERENCES TIPO_DOCUMENTOS (ID)
);


CREATE TABLE TIPO_ENDERECOS
(
	ID				INT				NOT NULL IDENTITY(1, 1),
	NOME			VARCHAR(50)		NOT NULL,
	DESCRICAO		VARCHAR(500)	NULL,
	CONSTRAINT 		PK_TIPO_ENDERECOS PRIMARY KEY (ID)
);

CREATE TABLE UF
(
	ID			INT			NOT NULL IDENTITY(1, 1),
	NOME		VARCHAR(50)	NOT NULL,
	SIGLA		VARCHAR(2)	NOT NULL,
	CONSTRAINT 	PK_UF PRIMARY KEY (ID)
);

CREATE TABLE CIDADE
(
	ID			INT			NOT NULL IDENTITY(1, 1),
	ID_UF		INT			NOT NULL,
	NOME		VARCHAR(50)	NOT NULL,
	N_IBGE		VARCHAR(8)	NULL,
	CONSTRAINT 	PK_CIDADE PRIMARY KEY (ID),
	CONSTRAINT 	FK_CIDADE_UF FOREIGN KEY (ID_UF)
	REFERENCES 	UF (ID)
);

CREATE TABLE CLIENTE_ENDERECOS
(
	ID					INT				NOT NULL IDENTITY(1, 1),
	ID_CLIENTE			INT				NOT NULL,
	ID_TIPO_ENDERECOS	INT				NOT NULL,
	ID_CIDADE			INT				NOT NULL,
	TIPO_LOGRADOURO		VARCHAR(20)		NOT NULL,
	NOME_LOGRADOURO		VARCHAR(100)	NOT NULL,
	NUMERO				VARCHAR(6)		NULL,
	COMPLEMENTO			VARCHAR(20)		NULL,
	BAIRRO				VARCHAR(50)		NOT NULL,
	CEP					VARCHAR(8)		NULL,
	CONSTRAINT PK_CLIENTE_ENDERECOS PRIMARY KEY (ID),
	CONSTRAINT FK_CLIENTE_ENDERECOS_CLIENTES FOREIGN KEY (ID_CLIENTE)
	REFERENCES CLIENTES (ID),
	CONSTRAINT FK_CLIENTE_ENDERECOS_TIPO_ENDERECO FOREIGN KEY (ID_TIPO_ENDERECOS)
	REFERENCES TIPO_ENDERECOS (ID),
	CONSTRAINT FK_CLIENTE_ENDERECOS_CIDADE FOREIGN KEY (ID_CIDADE)
	REFERENCES CIDADE (ID)
);

CREATE TABLE FORNECEDORES -- Entidade 5
(
	ID					INT				NOT NULL IDENTITY(1, 1),
	RAZAO_SOCIAL		VARCHAR(50)		NOT NULL,
	CNPJ				VARCHAR(30)		NOT NULL,
	DT_CADASTRO			DATE			NOT NULL,
	CONSTRAINT PK_FORNECEDORES	PRIMARY KEY (ID)
);

CREATE TABLE FORNECEDORES_FILIAIS
(
	ID					INT				NOT NULL IDENTITY(1, 1),
    ID_FORNECEDOR       INT             NOT NULL,
	RAZAO_SOCIAL		VARCHAR(50)		NOT NULL,
	CNPJ				VARCHAR(30)		NOT NULL,
	NOME_FANTASIA		VARCHAR(50)		NOT NULL,
	CONSTRAINT PK_FORNECEDORES_FILIAIS PRIMARY KEY (ID),
	CONSTRAINT FK_FORNECEDORES_FILIAIS_FORNECEDORES FOREIGN KEY (ID_FORNECEDOR)
	REFERENCES FORNECEDORES (ID)
);

CREATE TABLE FORNECEDORES_CONTATOS
(
	ID				INT 			NOT NULL IDENTITY(1, 1),
    ID_FORNECEDOR   INT             NOT NULL,
	TELEFONE		VARCHAR(15)		NOT NULL,
	EMAIL			VARCHAR(50)		NOT NULL,
	SETOR			VARCHAR(50)		NULL,
	CARGO			VARCHAR(50)		NULL
	CONSTRAINT PK_FORNECEDORES_CONTATOS PRIMARY KEY (ID),
	CONSTRAINT FK_FORNECEDORES_CONTATOS_FORNECEDORES FOREIGN KEY (ID_FORNECEDOR)
	REFERENCES FORNECEDORES (ID),
);

CREATE TABLE FORNECEDORES_ENDERECOS
(
	ID					INT				NOT NULL IDENTITY(1, 1),
	ID_FORNECEDOR		INT				NOT NULL,
	ID_TIPO_ENDERECOS	INT				NOT NULL,
	ID_CIDADE			INT				NOT NULL,
	TIPO_LOGRADOURO		VARCHAR(20)		NOT NULL,
	NOME_LOGRADOURO		VARCHAR(100)	NOT NULL,
	NUMERO				VARCHAR(6)		NULL,
	COMPLEMENTO			VARCHAR(20)		NULL,
	BAIRRO				VARCHAR(50)		NOT NULL,
	CEP					VARCHAR(8)		NULL,
	CONSTRAINT PK_FORNECEDORES_ENDERECOS PRIMARY KEY (ID),
	CONSTRAINT FK_FORNECEDORES_ENDERECOS_FORNECEDORES FOREIGN KEY (ID_FORNECEDOR)
	REFERENCES FORNECEDORES (ID),
	CONSTRAINT FK_FORNECEDOR_ENDERECOS_TIPO_ENDERECO FOREIGN KEY (ID_TIPO_ENDERECOS)
	REFERENCES TIPO_ENDERECOS (ID),
	CONSTRAINT FK_FORNECEDOR_ENDERECOS_CIDADE FOREIGN KEY (ID_CIDADE)
	REFERENCES CIDADE (ID)
);

CREATE TABLE LOJAS_FISICAS -- Entidade 6
(
	ID					INT 	NOT NULL IDENTITY(1, 1),
	NOME				VARCHAR(50)		NOT NULL,
	TIPO_LOGRADOURO		VARCHAR(20)		NOT NULL,
	NOME_LOGRADOURO		VARCHAR(100)	NOT NULL,
	NUMERO				VARCHAR(6)		NULL,
	COMPLEMENTO			VARCHAR(20)		NULL,
	BAIRRO				VARCHAR(50)		NOT NULL,
	CIDADE				VARCHAR(50)		NULL,
	ESTADO				VARCHAR(2)		NULL,
	PAIS				VARCHAR(60)		NULL,
	TELEFONE_CONTATO	VARCHAR(12)		NULL,
	CONSTRAINT PK_LOJAS_FISICAS PRIMARY KEY (ID)	
);

CREATE TABLE PRODUTO -- Entidade 7
(
	ID			INT				NOT NULL IDENTITY(1, 1),
	ID_LOJA		INT				NOT NULL,
	NOME		VARCHAR(50)		NOT NULL,
	DESCRICAO	VARCHAR(500)	NULL,
	VALOR_UN	DECIMAL(10, 2)	NOT NULL,
	QUANTIDADE	DECIMAL(10, 2)	NOT NULL,
	UNIDADE		VARCHAR(10)		NULL,
	CONSTRAINT PK_PRODUTO PRIMARY KEY (ID),
	CONSTRAINT FK_PRODUTO_LOJA_FISICA FOREIGN KEY (ID_LOJA) REFERENCES LOJAS_FISICAS (ID)
);

CREATE TABLE VARIACOES_PRODUTO
(
	ID			INT				NOT NULL IDENTITY(1, 1),
	ID_PRODUTO	INT				NOT NULL, 
	NOME		VARCHAR(30)		NOT NULL,
	DESCRICAO	VARCHAR(300)	NOT NULL,
	VALOR_UN	DECIMAL(10, 2)	NOT NULL,
	QUANTIDADE	DECIMAL(10, 2)	NOT NULL,
	CONSTRAINT PK_VARIACOES_PRODUTO PRIMARY KEY (ID),
	CONSTRAINT FK_VARIACOES_PRODUTO_PRODUTO FOREIGN KEY (ID_PRODUTO)
	REFERENCES PRODUTO (ID)
);

CREATE TABLE CONTROLE_ESTOQUE
(
	ID				INT				NOT NULL IDENTITY(1, 1),
	ID_PRODUTO		INT				NOT NULL,
	ID_USUARIO		INT				NOT NULL,
	ACAO			VARCHAR(10)		NOT NULL,
	QUANTIDADE		DECIMAL(10, 2)	NOT NULL,
	COMENTARIO_ACAO	VARCHAR(500)	NULL,
	DT_ACAO			DATE			NOT NULL,
	CONSTRAINT PK_CONTROLE_ESTOQUE PRIMARY KEY (ID),
	CONSTRAINT FK_CONTROLE_ESTOQUE_PRODUTO FOREIGN KEY (ID_PRODUTO)
	REFERENCES PRODUTO (ID),
	CONSTRAINT FK_CONTROLE_ESTOQUE_USUARIO FOREIGN KEY (ID_USUARIO)
	REFERENCES USUARIO (ID)
);

CREATE TABLE CUPOM_FISCAL_ITENS
(
	ID 			INT				NOT NULL IDENTITY(1, 1),
	ID_PRODUTO	INT				NOT NULL,
	VALOR		DECIMAL(10, 2)	NOT NULL,
	QUANTIDADE	DECIMAL(10, 2)	NOT NULL,
	CONSTRAINT PK_CUPOM_FISCAL_ITENS PRIMARY KEY (ID),
	CONSTRAINT FK_CUPOM_FISCAL_ITENS_PRODUTO FOREIGN KEY (ID_PRODUTO)
	REFERENCES PRODUTO (ID)
);

CREATE TABLE VENDAS -- Entidade 8
(
	ID				INT			NOT NULL IDENTITY(1, 1),
	ID_USUARIO		INT			NOT NULL,
	ID_CLIENTE		INT			NOT NULL,
	ID_CUPOM_FISCAL	INT			NOT NULL,
	VALOR_FINAL		DECIMAL(10, 2)	NOT NULL,
	PCT_DESCONTO	DECIMAL(10, 2)	NULL,
	DATA			DATETIME	NOT NULL,
	CONSTRAINT PK_VENDAS PRIMARY KEY (ID),
	CONSTRAINT FK_VENDAS_USUARIO FOREIGN KEY (ID_USUARIO)
	REFERENCES USUARIO (ID),
	CONSTRAINT FK_VENDAS_CLIENTES FOREIGN KEY (ID_CLIENTE)
	REFERENCES CLIENTES (ID),
	CONSTRAINT FK_VENDAS_CUPOM_FISCAL_ITENS FOREIGN KEY (ID_CUPOM_FISCAL)
	REFERENCES CUPOM_FISCAL_ITENS (ID)
);





